<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Memlabs | bluee :)</title>
<meta name="keywords" content="CTF, Writeup, Memory Forensics, Forensics">
<meta name="description" content="Complete Writeup Of Memlabs">
<meta name="author" content="Barshan Mondal">
<link rel="canonical" href="https://blueee04.github.io/blog/posts/2023-05-15-complete-memlabs-writeup/">
<link crossorigin="anonymous" href="/blog/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css" integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z&#43;V9&#43;cO1A=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://blueee04.github.io/blog/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://blueee04.github.io/blog/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://blueee04.github.io/blog/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://blueee04.github.io/blog/apple-touch-icon.png">
<link rel="mask-icon" href="https://blueee04.github.io/blog/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Memlabs" />
<meta property="og:description" content="Complete Writeup Of Memlabs" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blueee04.github.io/blog/posts/2023-05-15-complete-memlabs-writeup/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-15T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-05-15T00:00:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Memlabs"/>
<meta name="twitter:description" content="Complete Writeup Of Memlabs"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://blueee04.github.io/blog/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Memlabs",
      "item": "https://blueee04.github.io/blog/posts/2023-05-15-complete-memlabs-writeup/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Memlabs",
  "name": "Memlabs",
  "description": "Complete Writeup Of Memlabs",
  "keywords": [
    "CTF", "Writeup", "Memory Forensics", "Forensics"
  ],
  "articleBody": "Introduction In this blog post, I will be sharing a complete writeup on the Memlabs challenge. This challenge was created by my supersenior,Abhiram Bhaiya aka Stuxnet and it proved to be an exciting and educational experience. I will walk you through the steps I took to solve the challenge and provide insights into the techniques and tools used.\nChallenge Overview The Memlabs challenge is a Capture The Flag (CTF) challenge that focuses on memory forensics. It involves analyzing memory dumps to uncover hidden information and solve various puzzles and tasks. The challenge is designed to test your skills in reverse engineering, malware analysis, and memory analysis. There are 6 labs in total and i’ll be solving the 4 most important ones over here.\nApproach To solve the Memlabs challenge you will mostly need the volatility tool to analyze the memory dump for more artifacts, Here i’ll be using Volatility-2\nLab 1 Description My sister’s computer crashed. We were very fortunate to recover this memory dump. Your job is get all her important files from the system. From what we remember, we suddenly saw a black window pop up with some thing being executed. When the crash happened, she was trying to draw something. Thats all we remember from the time of crash.\nNote: This challenge is composed of 3 flags.\nFirst we get info on the system using imageinfo Flag 1: We can check the cmd line history from the console information using consoles to know what happened in the command line\nWe can see a weird string over there….we base64 it and we get the flag we want.\nFlag2: so as it is stated as important file we can grep the keyword\npython2 vol.py -f /mnt/c/Users/barsh/Downloads/Bi0s/MemLabs-Lab1/MemoryDump_Lab1.raw --profile=Win7SP1x64 filescan | grep -i important now we dump the file using dump files\nWe are asked for a pass to view so we extract the hashes using hashdump\nPutting the NTML hash in caps and passing it will reveal the file and we get the first flag\nFlag 3: Let us see the processes that were run in the system using pslist. we can see paint.exe was run in the system\nSo we dump the process using memdump and the process id of the process to analyse it :\nNo analyse this file we can use GIMP and adjusting the height and width and changing the offsets we can manage to get our flag.\nLab-2 Description One of the clients of our company, lost the access to his system due to an unknown error. He is supposedly a very popular “environmental” activist. As a part of the investigation, he told us that his go to applications are browsers, his password managers etc. We hope that you can dig into this memory dump and find his important stuff and give it back to us.\nNote: This challenge is composed of 3 flags.\nFlag 1: As we see the word enviromental is highlighted so the flag might me related so we check out the enviromental variables of the system using the envars command\nwe can see a string…..looks like a Base64…so let’s decode and we get our first flag.\nFlag 2: For the second flag the user tells us to check out his browsers and password managers as a hint….so let’s take a look at his processes\nAnd we see Keepass which as a open source password manager…could be useful…\nAs we know that keepass database has an extension of kdbx so let’s try grepping it in file scan and dump it\nNow it asks us for a masterkey which we have no clue of..let’s try grepping keywords like password or key…while grepping password we get a password.png file in the filescan\nDumping that we get a file where the pass is said in the left bottom corner…putting that we get a lot entries…one of them is flag we right-click it and get the flag from it.\nFlag 3: For the last flag the client tells us to look through his browsers so we can see chrome is his most extensively used browser….so let’s install a plugin for that in volatility known as chromehistory.py\nrunning that command we get the chrome history:\nWe can see a MEGA link following it we get a zipped PNG file which we can open using the flag used in Lab - 1…If you still haven’t completed that refer to my Lab-1 writeup.\nNow we have all three flags.\nLab-3 Description: A malicious script encrypted a very secret piece of information I had on my system. Can you recover the information for me please?\nNote-1: This challenge is composed of only 1 flag. The flag split into 2 parts.\nNote-2: You’ll need the first half of the flag to get the second.\nYou will need this additional tool to solve the challenge,\n$ sudo apt install steghide The flag format for this lab is: inctf{s0me_l33t_Str1ng}\nFinal Flag: So for this challenge the flag is divided into two parts…so for the first part it says that the malicious code encrypts the info….so let’s say it’s a .py script.\nso let’s try to look for em\nafter grepping for .py we get a file named evil-script…\nhaving a look at the script…it xors a string and then b64 it…so we need to find the output of the code… It’s say it output’s as vip.txt….sp let’s try to find it and dump it\nNow let’s base64 it and XOR it\nNow we have the first part…\nOk for the second part….\nWe are told we need to use steghide for the challenge so let’s try to get the jpg or jpeg filesss\nNow we use steghide…and use the first part of the flag as the passphrase….And there u go we get the second part as well…\nLab-4 Description: My system was recently compromised. The Hacker stole a lot of information but he also deleted a very important file of mine. I have no idea on how to recover it. The only evidence we have, at this point of time is this memory dump. Please help me.\nNote: This challenge is composed of only 1 flag.\nThe flag format for this lab is: inctf{s0me_l33t_Str1ng}\nFlag : So for this challenge the description tells us his information was deleted by a hacker so let’s take a look at his files….we first run pslist on the dump :\nWe can see we have a StickyNot process running so let’s find a file for that in file scan….after getting the file we open it but the flag isn’t there…..well but there’s something about clip board\nSo let’s run the clip board plugin…\nStill nothing it seems\nLet’s look into the most targeted folders like desktop….we found two images over there…one of them is halfed it seems…let’s manually change it’s height and width to get the complete image….we have it but no flag\nFor the second image….as it’s a jpeg let’s run steghide on it….okay we have a text filee\nStill no flag :(\nAs the client says that the info deleted was important let’s try grepping the keyword important…and we get a file called important.txt…but we are not able to grep it cause it’s deleted\nOkay as the Desc says the info was deleted….let’s check out mftparser as we know what mft stores metadata on all the files on the system even if after they are deleted…let’s flush all the data to a txt file\nAfter that searching for the IMPORTANT.txt file which we looked up earlier gave us the flag :p\nf{1_is_n0t_EQu4l_7o_2_bUt_yh1s_d0s3nt_m4ke_s3ns3}\nBig shoutout to all of you awesome folks for sticking around till the end. You rock.\n",
  "wordCount" : "1273",
  "inLanguage": "en",
  "datePublished": "2023-05-15T00:00:00Z",
  "dateModified": "2023-05-15T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Barshan Mondal"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://blueee04.github.io/blog/posts/2023-05-15-complete-memlabs-writeup/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "bluee :)",
    "logo": {
      "@type": "ImageObject",
      "url": "https://blueee04.github.io/blog/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://blueee04.github.io/blog/" accesskey="h" title="bluee :) (Alt + H)">bluee :)</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://blueee04.github.io/blog/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://blueee04.github.io/blog/">Home</a>&nbsp;»&nbsp;<a href="https://blueee04.github.io/blog/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Memlabs
    </h1>
    <div class="post-meta"><span title='2023-05-15 00:00:00 +0000 UTC'>May 15, 2023</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;Barshan Mondal

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#introduction" aria-label="Introduction">Introduction</a><ul>
                        
                <li>
                    <a href="#challenge-overview" aria-label="Challenge Overview">Challenge Overview</a></li>
                <li>
                    <a href="#approach" aria-label="Approach">Approach</a></li>
                <li>
                    <a href="#lab-1" aria-label="Lab 1">Lab 1</a><ul>
                        
                <li>
                    <a href="#description" aria-label="Description">Description</a></li>
                <li>
                    <a href="#flag-1" aria-label="Flag 1:">Flag 1:</a></li>
                <li>
                    <a href="#flag2" aria-label="Flag2:">Flag2:</a></li>
                <li>
                    <a href="#flag-3" aria-label="Flag 3:">Flag 3:</a></li></ul>
                </li>
                <li>
                    <a href="#lab-2" aria-label="Lab-2">Lab-2</a><ul>
                        
                <li>
                    <a href="#description-1" aria-label="Description">Description</a></li>
                <li>
                    <a href="#flag-1-1" aria-label="Flag 1:">Flag 1:</a></li>
                <li>
                    <a href="#flag-2" aria-label="Flag 2:">Flag 2:</a></li>
                <li>
                    <a href="#flag-3-1" aria-label="Flag 3:">Flag 3:</a></li></ul>
                </li>
                <li>
                    <a href="#lab-3" aria-label="Lab-3">Lab-3</a><ul>
                        
                <li>
                    <a href="#description-2" aria-label="Description:">Description:</a></li>
                <li>
                    <a href="#final-flag" aria-label="Final Flag:">Final Flag:</a></li></ul>
                </li>
                <li>
                    <a href="#lab-4" aria-label="Lab-4">Lab-4</a><ul>
                        
                <li>
                    <a href="#description-3" aria-label="Description:">Description:</a></li>
                <li>
                    <a href="#flag-" aria-label="Flag :">Flag :</a>
                </li>
            </ul>
            </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="introduction">Introduction<a hidden class="anchor" aria-hidden="true" href="#introduction">#</a></h1>
<p>In this blog post, I will be sharing a complete writeup on the <a href="https://github.com/stuxnet999/MemLabs">Memlabs</a> challenge. This challenge was created by my supersenior,Abhiram Bhaiya aka Stuxnet and it proved to be an exciting and educational experience. I will walk you through the steps I took to solve the challenge and provide insights into the techniques and tools used.</p>
<h2 id="challenge-overview">Challenge Overview<a hidden class="anchor" aria-hidden="true" href="#challenge-overview">#</a></h2>
<p>The Memlabs challenge is a Capture The Flag (CTF) challenge that focuses on memory forensics. It involves analyzing memory dumps to uncover hidden information and solve various puzzles and tasks. The challenge is designed to test your skills in reverse engineering, malware analysis, and memory analysis.
There are 6 labs in total and i&rsquo;ll be solving the 4 most important ones over here.</p>
<h2 id="approach">Approach<a hidden class="anchor" aria-hidden="true" href="#approach">#</a></h2>
<p>To solve the Memlabs challenge you will mostly need the volatility tool to analyze the memory dump for more artifacts, Here i&rsquo;ll be using <em>Volatility-2</em></p>
<hr>
<h2 id="lab-1">Lab 1<a hidden class="anchor" aria-hidden="true" href="#lab-1">#</a></h2>
<h3 id="description">Description<a hidden class="anchor" aria-hidden="true" href="#description">#</a></h3>
<p>My sister&rsquo;s computer crashed. We were very fortunate to recover this memory dump. Your job is get all her important files from the system. From what we remember, we suddenly saw a black window pop up with some thing being executed. When the crash happened, she was trying to draw something. Thats all we remember from the time of crash.</p>
<p><strong>Note</strong>: This challenge is composed of 3 flags.</p>
<p>First we get info on the system using imageinfo
<img loading="lazy" src="https://raw.githubusercontent.com/blueee04/Memlabs/main/MemLabs-Writeups/Lab-1/images/imageinfo.png" alt=""  />
</p>
<h3 id="flag-1">Flag 1:<a hidden class="anchor" aria-hidden="true" href="#flag-1">#</a></h3>
<p>We can check the cmd line history from the console information using consoles to know what happened in the command line</p>
<p><img loading="lazy" src="https://github.com/blueee04/Memlabs/raw/main/MemLabs-Writeups/Lab-1/images/consoles1.png" alt=""  />
</p>
<p>We can see a weird string over there&hellip;.we base64 it and we get the flag we want.</p>
<h3 id="flag2">Flag2:<a hidden class="anchor" aria-hidden="true" href="#flag2">#</a></h3>
<p>so as it is stated as important file we can grep the keyword</p>
<pre tabindex="0"><code>python2 vol.py -f /mnt/c/Users/barsh/Downloads/Bi0s/MemLabs-Lab1/MemoryDump_Lab1.raw --profile=Win7SP1x64 filescan | grep -i important
</code></pre><p>now we dump the file using dump files</p>
<p><img loading="lazy" src="https://github.com/blueee04/Memlabs/raw/main/MemLabs-Writeups/Lab-1/images/dumpfiles1.png" alt=""  />
</p>
<p>We are asked for a pass to view so we extract the hashes using hashdump</p>
<p><img loading="lazy" src="https://github.com/blueee04/Memlabs/raw/main/MemLabs-Writeups/Lab-1/images/Hashdump.png" alt=""  />
</p>
<p>Putting the NTML hash in caps and passing it will reveal the file and we get the first flag</p>
<h3 id="flag-3">Flag 3:<a hidden class="anchor" aria-hidden="true" href="#flag-3">#</a></h3>
<p>Let us see the processes that were run in the system using pslist.
<img loading="lazy" src="https://github.com/blueee04/Memlabs/raw/main/MemLabs-Writeups/Lab-1/images/pslist.png" alt=""  />
</p>
<p>we can see paint.exe was run in the system</p>
<p><img loading="lazy" src="https://github.com/blueee04/Memlabs/raw/main/MemLabs-Writeups/Lab-1/images/mspaintevidence.png" alt=""  />
</p>
<p>So we dump the process using memdump and the process id of the process to analyse it :</p>
<p><img loading="lazy" src="https://github.com/blueee04/Memlabs/raw/main/MemLabs-Writeups/Lab-1/images/memdump.png" alt=""  />
</p>
<p>No analyse this file we can use GIMP and adjusting the height and width and changing the offsets we can manage to get our flag.</p>
<p><img loading="lazy" src="https://github.com/blueee04/Memlabs/raw/main/MemLabs-Writeups/Lab-1/images/flag.png" alt=""  />
</p>
<hr>
<h2 id="lab-2">Lab-2<a hidden class="anchor" aria-hidden="true" href="#lab-2">#</a></h2>
<h3 id="description-1">Description<a hidden class="anchor" aria-hidden="true" href="#description-1">#</a></h3>
<p>One of the clients of our company, lost the access to his system due to an unknown error. He is supposedly a very popular &ldquo;environmental&rdquo; activist. As a part of the investigation, he told us that his go to applications are browsers, his password managers etc. We hope that you can dig into this memory dump and find his important stuff and give it back to us.</p>
<p><strong>Note: This challenge is composed of 3 flags.</strong></p>
<h3 id="flag-1-1">Flag 1:<a hidden class="anchor" aria-hidden="true" href="#flag-1-1">#</a></h3>
<p>As we see the word enviromental is highlighted so the flag might me related so we check out the enviromental variables of the system using the envars command</p>
<p><img loading="lazy" src="https://github.com/blueee04/Memlabs/raw/main/MemLabs-Writeups/Lab-2/images/envars.png" alt=""  />
</p>
<p>we can see a string&hellip;..looks like a Base64&hellip;so let&rsquo;s decode and we get our first flag.</p>
<h3 id="flag-2">Flag 2:<a hidden class="anchor" aria-hidden="true" href="#flag-2">#</a></h3>
<p>For the second flag the user tells us to check out his browsers and password managers as a hint&hellip;.so let&rsquo;s take a look at his processes</p>
<p><img loading="lazy" src="https://github.com/blueee04/Memlabs/raw/main/MemLabs-Writeups/Lab-2/images/pslist.png" alt=""  />
</p>
<p><img loading="lazy" src="https://github.com/blueee04/Memlabs/raw/main/MemLabs-Writeups/Lab-2/images/keepass.png" alt=""  />
</p>
<p>And we see Keepass which as a open source password manager&hellip;could be useful&hellip;</p>
<p>As we know that keepass database has an extension of kdbx so let&rsquo;s try grepping it in file scan and dump it</p>
<p><img loading="lazy" src="https://github.com/blueee04/Memlabs/raw/main/MemLabs-Writeups/Lab-2/images/kdbx%20grep.png" alt=""  />
</p>
<p><img loading="lazy" src="https://github.com/blueee04/Memlabs/raw/main/MemLabs-Writeups/Lab-2/images/dump%20databsr.png" alt=""  />
</p>
<p>Now it asks us for a masterkey which we have no clue of..let&rsquo;s try grepping keywords like password or key&hellip;while grepping password we get a password.png file in the filescan</p>
<p><img loading="lazy" src="https://github.com/blueee04/Memlabs/raw/main/MemLabs-Writeups/Lab-2/images/password.png%20grep.png" alt=""  />
</p>
<p><img loading="lazy" src="https://github.com/blueee04/Memlabs/raw/main/MemLabs-Writeups/Lab-2/images/dump%20png.png" alt=""  />
</p>
<p>Dumping that we get a file where the pass is said in the left bottom corner&hellip;putting that we get a lot entries&hellip;one of them is flag we right-click it and get the flag from it.</p>
<h3 id="flag-3-1">Flag 3:<a hidden class="anchor" aria-hidden="true" href="#flag-3-1">#</a></h3>
<p>For the last flag the client tells us to look through his browsers so we can see chrome is his most extensively used browser&hellip;.so let&rsquo;s install a plugin for that in volatility known as chromehistory.py</p>
<p>running that command we get the chrome history:</p>
<p><img loading="lazy" src="https://github.com/blueee04/Memlabs/raw/main/MemLabs-Writeups/Lab-2/images/chromehistory.png" alt=""  />
</p>
<p>We can see a MEGA link following it we get a zipped PNG file which we can open using the flag used in Lab - 1&hellip;If you still haven&rsquo;t completed that refer to my Lab-1 writeup.</p>
<p>Now we have all three flags.</p>
<hr>
<h2 id="lab-3">Lab-3<a hidden class="anchor" aria-hidden="true" href="#lab-3">#</a></h2>
<h3 id="description-2">Description:<a hidden class="anchor" aria-hidden="true" href="#description-2">#</a></h3>
<p>A malicious script encrypted a very secret piece of information I had on my system. Can you recover the information for me please?</p>
<p>Note-1: This challenge is composed of only 1 flag. The flag split into 2 parts.</p>
<p>Note-2: You&rsquo;ll need the first half of the flag to get the second.</p>
<p>You will need this additional tool to solve the challenge,</p>
<pre tabindex="0"><code>$ sudo apt install steghide
</code></pre><p>The flag format for this lab is: inctf{s0me_l33t_Str1ng}</p>
<h3 id="final-flag">Final Flag:<a hidden class="anchor" aria-hidden="true" href="#final-flag">#</a></h3>
<p>So for this challenge the flag is divided into two parts&hellip;so for the first part it says that the malicious code encrypts the info&hellip;.so let&rsquo;s say it&rsquo;s a .py script.</p>
<p>so let&rsquo;s try to look for em</p>
<p>after grepping for .py we get a file named evil-script&hellip;</p>
<p><img loading="lazy" src="https://github.com/blueee04/Memlabs/raw/main/MemLabs-Writeups/Lab3/images/evilscript.png" alt=""  />
</p>
<p>having a look at the script&hellip;it xors a string and then b64 it&hellip;so we need to find the output of the code&hellip;
It&rsquo;s say it output&rsquo;s as vip.txt&hellip;.sp let&rsquo;s try to find it and dump it</p>
<p><img loading="lazy" src="https://github.com/blueee04/Memlabs/raw/main/MemLabs-Writeups/Lab3/images/vip.png" alt=""  />
</p>
<p>Now let&rsquo;s base64 it and XOR it</p>
<p><img loading="lazy" src="https://github.com/blueee04/Memlabs/raw/main/MemLabs-Writeups/Lab3/images/Base64.png" alt=""  />

<img loading="lazy" src="https://github.com/blueee04/Memlabs/raw/main/MemLabs-Writeups/Lab3/images/1st%20half%20xor.png" alt=""  />
</p>
<p>Now we have the first part&hellip;</p>
<p>Ok for the second part&hellip;.</p>
<p>We are told we need to use steghide for the challenge so let&rsquo;s try to get the jpg or jpeg filesss</p>
<p><img loading="lazy" src="https://github.com/blueee04/Memlabs/raw/main/MemLabs-Writeups/Lab3/images/jpeg.png" alt=""  />
</p>
<p>Now we use steghide&hellip;and use the first part of the flag as the passphrase&hellip;.And there u go we get the second part as well&hellip;</p>
<p><img loading="lazy" src="https://github.com/blueee04/Memlabs/raw/main/MemLabs-Writeups/Lab3/images/final.png" alt=""  />
</p>
<hr>
<h2 id="lab-4">Lab-4<a hidden class="anchor" aria-hidden="true" href="#lab-4">#</a></h2>
<h3 id="description-3">Description:<a hidden class="anchor" aria-hidden="true" href="#description-3">#</a></h3>
<p>My system was recently compromised. The Hacker stole a lot of information but he also deleted a very important file of mine. I have no idea on how to recover it. The only evidence we have, at this point of time is this memory dump. Please help me.</p>
<p><strong>Note: This challenge is composed of only 1 flag.</strong></p>
<p>The flag format for this lab is: inctf{s0me_l33t_Str1ng}</p>
<h3 id="flag-">Flag :<a hidden class="anchor" aria-hidden="true" href="#flag-">#</a></h3>
<p>So for this challenge the description tells us his information was deleted by a hacker so let&rsquo;s take a look at his files&hellip;.we first run pslist on the dump :</p>
<p><img loading="lazy" src="https://github.com/blueee04/Memlabs/raw/main/MemLabs-Writeups/Lab-4/images/pslist.png" alt=""  />
</p>
<p>We can see we have a StickyNot process running so let&rsquo;s find a file for that in file scan&hellip;.after getting the file we open it but the flag isn&rsquo;t there&hellip;..well but there&rsquo;s something about clip board</p>
<p><img loading="lazy" src="https://github.com/blueee04/Memlabs/raw/main/MemLabs-Writeups/Lab-4/images/stiky.png" alt=""  />
</p>
<p>So let&rsquo;s run the clip board plugin&hellip;</p>
<p><img loading="lazy" src="https://github.com/blueee04/Memlabs/raw/main/MemLabs-Writeups/Lab-4/images/clipboard.png" alt=""  />
</p>
<p>Still nothing it seems</p>
<p>Let&rsquo;s look into the most targeted folders like desktop&hellip;.we found two images over there&hellip;one of them is halfed it seems&hellip;let&rsquo;s manually change it&rsquo;s height and width to get the complete image&hellip;.we have it but no flag</p>
<p><img loading="lazy" src="https://github.com/blueee04/Memlabs/raw/main/MemLabs-Writeups/Lab-4/images/ss.png" alt=""  />
</p>
<p>For the second image&hellip;.as it&rsquo;s a jpeg let&rsquo;s run steghide on it&hellip;.okay we have a text filee</p>
<p><img loading="lazy" src="https://github.com/blueee04/Memlabs/raw/main/MemLabs-Writeups/Lab-4/images/stegsolve.png" alt=""  />
</p>
<p>Still no flag :(</p>
<p><img loading="lazy" src="https://github.com/blueee04/Memlabs/raw/main/MemLabs-Writeups/Lab-4/images/galf1.jpeg" alt=""  />
</p>
<p>As the client says that the info deleted was important let&rsquo;s try grepping the keyword important&hellip;and we get a file called important.txt&hellip;but we are not able to grep it cause it&rsquo;s deleted</p>
<p><img loading="lazy" src="https://github.com/blueee04/Memlabs/raw/main/MemLabs-Writeups/Lab-4/images/shellbags%20imp.txt.png" alt=""  />
</p>
<p>Okay as the Desc says the info was deleted&hellip;.let&rsquo;s check out mftparser as we know what mft stores metadata on all the files on the system even if after they are deleted&hellip;let&rsquo;s flush all the data to a txt file</p>
<p><img loading="lazy" src="https://github.com/blueee04/Memlabs/raw/main/MemLabs-Writeups/Lab-4/images/mftparser.png" alt=""  />
</p>
<p>After that searching for the IMPORTANT.txt file which we looked up earlier gave us the flag :p</p>
<p><strong>f{1_is_n0t_EQu4l_7o_2_bUt_yh1s_d0s3nt_m4ke_s3ns3}</strong></p>
<p><strong>Big shoutout to all of you awesome folks for sticking around till the end. You rock.</strong></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://blueee04.github.io/blog/tags/ctf/">CTF</a></li>
      <li><a href="https://blueee04.github.io/blog/tags/writeup/">Writeup</a></li>
      <li><a href="https://blueee04.github.io/blog/tags/memory-forensics/">Memory Forensics</a></li>
      <li><a href="https://blueee04.github.io/blog/tags/forensics/">Forensics</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://blueee04.github.io/blog/posts/2023-06-12-bluetooth-mouse-network-capture/">
    <span class="title">« Prev</span>
    <br>
    <span>Bluetooth Mouse Network Capture</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Memlabs on x"
            href="https://x.com/intent/tweet/?text=Memlabs&amp;url=https%3a%2f%2fblueee04.github.io%2fblog%2fposts%2f2023-05-15-complete-memlabs-writeup%2f&amp;hashtags=CTF%2cWriteup%2cMemoryForensics%2cForensics">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Memlabs on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fblueee04.github.io%2fblog%2fposts%2f2023-05-15-complete-memlabs-writeup%2f&amp;title=Memlabs&amp;summary=Memlabs&amp;source=https%3a%2f%2fblueee04.github.io%2fblog%2fposts%2f2023-05-15-complete-memlabs-writeup%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Memlabs on reddit"
            href="https://reddit.com/submit?url=https%3a%2f%2fblueee04.github.io%2fblog%2fposts%2f2023-05-15-complete-memlabs-writeup%2f&title=Memlabs">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Memlabs on facebook"
            href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fblueee04.github.io%2fblog%2fposts%2f2023-05-15-complete-memlabs-writeup%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Memlabs on whatsapp"
            href="https://api.whatsapp.com/send?text=Memlabs%20-%20https%3a%2f%2fblueee04.github.io%2fblog%2fposts%2f2023-05-15-complete-memlabs-writeup%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Memlabs on telegram"
            href="https://telegram.me/share/url?text=Memlabs&amp;url=https%3a%2f%2fblueee04.github.io%2fblog%2fposts%2f2023-05-15-complete-memlabs-writeup%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Memlabs on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=Memlabs&u=https%3a%2f%2fblueee04.github.io%2fblog%2fposts%2f2023-05-15-complete-memlabs-writeup%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2025 <a href="https://blueee04.github.io/blog/">bluee :)</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
